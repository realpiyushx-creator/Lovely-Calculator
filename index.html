<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Lovely Calc</title>
  <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@300;400;600&display=swap" rel="stylesheet" />
  <style>
    /* Reset / base */
    * {
      box-sizing: border-box;
    }
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
    }
    body {
      font-family: "Quicksand", sans-serif;
      overflow: hidden;
      touch-action: manipulation;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #fdf2ff;
      position: relative;
    }

    /* Animated Gradient Background */
    .gradient-bg {
      background: linear-gradient(-45deg, #ff9a9e, #fad0c4, #ffd1ff, #a18cd1, #fbc2eb);
      background-size: 400% 400%;
      animation: gradientBG 15s ease infinite;
      position: absolute;
      inset: 0;
      z-index: -2;
    }

    @keyframes gradientBG {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    /* Floating Orbs */
    .orb {
      position: absolute;
      border-radius: 50%;
      filter: blur(80px);
      opacity: 0.6;
      z-index: -1;
      animation: floatOrb 20s infinite alternate;
    }

    .orb-1 {
      width: 400px;
      height: 400px;
      background: #ffecd2;
      top: -100px;
      left: -100px;
    }

    .orb-2 {
      width: 300px;
      height: 300px;
      background: #fcb69f;
      bottom: -50px;
      right: -50px;
      animation-delay: -5s;
    }

    @keyframes floatOrb {
      0% { transform: translate(0, 0) rotate(0deg); }
      100% { transform: translate(30px, 50px) rotate(20deg); }
    }

    /* Calculator body */
    .calculator {
      width: min(360px, 90vw);
      height: min(650px, 85vh);
      padding: 24px;
      border-radius: 30px;
      background: rgba(255, 255, 255, 0.25);
      box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.15);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.4);
      display: flex;
      flex-direction: column;
      position: relative;
      z-index: 10;
    }

    /* Header */
    .calc-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 16px;
      opacity: 0.8;
      color: #fff;
    }

    .calc-header-left {
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .calc-title {
      font-size: 10px;
      font-weight: 700;
      letter-spacing: 0.16em;
      text-transform: uppercase;
    }

    .header-dots {
      display: flex;
      gap: 4px;
    }

    .header-dot {
      width: 8px;
      height: 8px;
      border-radius: 999px;
      background: rgba(255, 255, 255, 0.7);
    }

    /* Display */
    .display-wrapper {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: flex-end;
      justify-content: flex-end;
      margin-bottom: 24px;
      padding: 0 8px;
    }

    #history {
      color: rgba(245, 245, 245, 0.85);
      font-size: 13px;
      font-weight: 300;
      height: 20px;
      max-width: 100%;
      text-align: right;
      overflow: hidden;
      white-space: nowrap;
      text-overflow: ellipsis;
    }

    #display {
      color: #fff;
      font-weight: 300;
      font-size: 40px;
      line-height: 1.1;
      max-width: 100%;
      text-align: right;
      overflow: hidden;
      white-space: nowrap;
      text-overflow: ellipsis;
      text-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      transition: font-size 0.15s ease;
    }

    /* Keypad grid */
    .keypad {
      display: grid;
      grid-template-columns: repeat(4, minmax(0, 1fr));
      gap: 12px;
      height: 60%;
    }

    .calc-btn {
      border-radius: 18px;
      border: 1px solid rgba(255, 255, 255, 0.4);
      background: rgba(255, 255, 255, 0.3);
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
      font-size: 24px;
      font-weight: 300;
      color: #fff;
      outline: none;
      border-style: solid;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 6px 10px;
      transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      position: relative;
      overflow: hidden;
      cursor: pointer;
    }

    .calc-btn:active {
      transform: scale(0.9);
      background: rgba(255, 255, 255, 0.5);
    }

    .calc-btn:hover {
      background: rgba(255, 255, 255, 0.45);
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(255, 182, 193, 0.4);
    }

    .btn-text-small {
      font-size: 18px;
      font-weight: 600;
    }

    .btn-operator {
      background: rgba(255, 105, 180, 0.2);
      color: #d63384;
      font-weight: 600;
    }

    .btn-operator:hover {
      background: rgba(255, 105, 180, 0.35);
    }

    .btn-equals {
      background: linear-gradient(135deg, #f6d365 0%, #fda085 100%);
      color: #fff;
      border: none;
      box-shadow: 0 0 25px rgba(253, 160, 133, 0.6);
      font-size: 26px;
    }

    .btn-clear {
      background: rgba(255, 255, 255, 0.2);
      color: #ff6b6b;
      font-weight: 700;
      font-size: 18px;
    }

    .btn-zero {
      grid-column: span 2;
      justify-content: flex-start;
      padding-left: 24px;
    }

    /* Particles */
    .particle {
      position: absolute;
      pointer-events: none;
      animation: pop 0.8s ease-out forwards;
    }

    @keyframes pop {
      0% { transform: translate(-50%, -50%) scale(0); opacity: 1; }
      100% {
        transform: translate(-50%, -50%) scale(1.5) translate(var(--tx), var(--ty));
        opacity: 0;
      }
    }

    /* Confetti */
    .confetti {
      position: absolute;
      width: 10px;
      height: 10px;
      background-color: #f00;
      animation: confetti-fall 3s linear forwards;
      z-index: 50;
    }

    @keyframes confetti-fall {
      0% { transform: translateY(-10vh) rotate(0deg); opacity: 1; }
      100% { transform: translateY(110vh) rotate(720deg); opacity: 0; }
    }
  </style>
</head>
<body>
  <div class="gradient-bg"></div>
  <div class="orb orb-1"></div>
  <div class="orb orb-2"></div>
  <div id="particles-container" style="position:fixed; inset:0; pointer-events:none; z-index:50;"></div>

  <div class="calculator">
    <div class="calc-header">
      <div class="calc-header-left">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"></path>
        </svg>
        <span class="calc-title">Lovely Calc</span>
      </div>
      <div class="header-dots">
        <span class="header-dot"></span>
        <span class="header-dot"></span>
        <span class="header-dot"></span>
      </div>
    </div>

    <div class="display-wrapper">
      <div id="history" class="text-pink-400 text-sm mb-1 h-6 font-semibold tracking-wide text-right truncate w-full" style="text-shadow: 0 0 8px rgba(255, 255, 255, 0.9);"></div>
      <div id="display">0</div>
    </div>

    <div class="keypad">
      <!-- Row 1 -->
      <button onclick="clearDisplay()" class="calc-btn btn-clear btn-text-small">AC</button>
      <button onclick="deleteLast()" class="calc-btn btn-clear">
        ü°®
      </button>
      <button onclick="appendOperator('%')" class="calc-btn btn-operator btn-text-small">%</button>
      <button onclick="appendOperator('/')" class="calc-btn btn-operator btn-text-small">√∑</button>

      <!-- Row 2 -->
      <button onclick="appendNumber('7')" class="calc-btn">7</button>
      <button onclick="appendNumber('8')" class="calc-btn">8</button>
      <button onclick="appendNumber('9')" class="calc-btn">9</button>
      <button onclick="appendOperator('*')" class="calc-btn btn-operator btn-text-small">√ó</button>

      <!-- Row 3 -->
      <button onclick="appendNumber('4')" class="calc-btn">4</button>
      <button onclick="appendNumber('5')" class="calc-btn">5</button>
      <button onclick="appendNumber('6')" class="calc-btn">6</button>
      <button onclick="appendOperator('-')" class="calc-btn btn-operator btn-text-small">‚àí</button>

      <!-- Row 4 -->
      <button onclick="appendNumber('1')" class="calc-btn">1</button>
      <button onclick="appendNumber('2')" class="calc-btn">2</button>
      <button onclick="appendNumber('3')" class="calc-btn">3</button>
      <button onclick="appendOperator('+')" class="calc-btn btn-operator btn-text-small">+</button>

      <!-- Row 5 -->
      <button onclick="appendNumber('0')" class="calc-btn btn-zero">0</button>
      <button onclick="appendNumber('.')" class="calc-btn">.</button>
      <button onclick="calculate()" class="calc-btn btn-equals">=</button>
    </div>
  </div>

  <script>
    let currentInput = "0";
    let previousInput = "";
    let operator = null;
    let shouldResetScreen = false;

    const display = document.getElementById("display");
    const history = document.getElementById("history");
    const particleContainer = document.getElementById("particles-container");

    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

    function playSound(type) {
      if (audioCtx.state === "suspended") audioCtx.resume();
      const osc = audioCtx.createOscillator();
      const gainNode = audioCtx.createGain();

      osc.connect(gainNode);
      gainNode.connect(audioCtx.destination);

      if (type === "click") {
        osc.type = "sine";
        osc.frequency.setValueAtTime(600, audioCtx.currentTime);
        osc.frequency.exponentialRampToValueAtTime(300, audioCtx.currentTime + 0.1);
        gainNode.gain.setValueAtTime(0.1, audioCtx.currentTime);
        gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.1);
        osc.start();
        osc.stop(audioCtx.currentTime + 0.1);
      } else if (type === "success") {
        osc.type = "triangle";
        osc.frequency.setValueAtTime(400, audioCtx.currentTime);
        osc.frequency.linearRampToValueAtTime(800, audioCtx.currentTime + 0.1);
        gainNode.gain.setValueAtTime(0.1, audioCtx.currentTime);
        gainNode.gain.linearRampToValueAtTime(0, audioCtx.currentTime + 0.3);
        osc.start();
        osc.stop(audioCtx.currentTime + 0.3);
      }
    }

    function updateDisplay() {
      display.textContent = currentInput.substring(0, 11);
      if (currentInput.length > 8) display.style.fontSize = "2.5rem";
      else if (currentInput.length > 6) display.style.fontSize = "3.5rem";
      else display.style.fontSize = "4rem";
    }

    function appendNumber(number) {
      playSound("click");
      createParticles(event);
      if (currentInput === "0" || shouldResetScreen) {
        currentInput = number;
        shouldResetScreen = false;
      } else {
        currentInput += number;
      }
      updateDisplay();
    }

    function appendOperator(op) {
      playSound("click");
      createParticles(event, "star");

      if (operator !== null) calculate();
      previousInput = currentInput;
      operator = op;
      history.textContent = `${previousInput} ${op === "*" ? "√ó" : op === "/" ? "√∑" : op}`;
      shouldResetScreen = true;
    }

    function clearDisplay() {
      playSound("click");
      currentInput = "0";
      previousInput = "";
      operator = null;
      history.textContent = "";
      updateDisplay();
    }

    function deleteLast() {
      playSound("click");
      if (currentInput.length > 1) {
        currentInput = currentInput.slice(0, -1);
      } else {
        currentInput = "0";
      }
      updateDisplay();
    }

    function calculate() {
      if (operator === null || shouldResetScreen) return;
      playSound("success");
      explodeConfetti();

      let result;
      const prev = parseFloat(previousInput);
      const current = parseFloat(currentInput);

      if (isNaN(prev) || isNaN(current)) return;

      switch (operator) {
        case "+": result = prev + current; break;
        case "-": result = prev - current; break;
        case "*": result = prev * current; break;
        case "/": result = prev / current; break;
        case "%": result = prev % current; break;
        default: return;
      }

      if (result === 143 || result === 520) {
        history.textContent = "I Love You ‚ù§Ô∏è";
      } else {
        history.textContent =
          `${previousInput} ${operator === "*" ? "√ó" : operator === "/" ? "√∑" : operator} ${currentInput} =`;
      }

      currentInput = result.toString();
      operator = null;
      shouldResetScreen = true;
      updateDisplay();
    }

    function createParticles(e, type = "heart") {
      const rect = e.target.getBoundingClientRect();
      const x = rect.left + rect.width / 2;
      const y = rect.top + rect.height / 2;

      for (let i = 0; i < 6; i++) {
        const particle = document.createElement("div");
        particle.classList.add("particle");

        const colors = ["#ff9a9e", "#a18cd1", "#fad0c4", "#ffffff"];
        particle.style.backgroundColor =
          type === "heart" ? "transparent" : colors[Math.floor(Math.random() * colors.length)];

        if (type === "heart") {
          particle.innerHTML = ["‚ù§Ô∏è", "‚ú®", "üå∏"][Math.floor(Math.random() * 3)];
          particle.style.fontSize = Math.random() * 10 + 10 + "px";
        } else {
          const size = Math.random() * 6 + 2;
          particle.style.width = `${size}px`;
          particle.style.height = `${size}px`;
          particle.style.borderRadius = "50%";
        }

        particle.style.left = `${x}px`;
        particle.style.top = `${y}px`;

        const angle = Math.random() * 2 * Math.PI;
        const velocity = Math.random() * 100 + 50;
        const tx = Math.cos(angle) * velocity + "px";
        const ty = Math.sin(angle) * velocity + "px";

        particle.style.setProperty("--tx", tx);
        particle.style.setProperty("--ty", ty);

        particleContainer.appendChild(particle);

        setTimeout(() => {
          particle.remove();
        }, 800);
      }
    }

    function explodeConfetti() {
      const colors = ["#ff9a9e", "#a18cd1", "#fbc2eb", "#ffffff", "#ffd1ff"];
      for (let i = 0; i < 50; i++) {
        const confetti = document.createElement("div");
        confetti.classList.add("confetti");
        confetti.style.left = Math.random() * 100 + "vw";
        confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
        confetti.style.animationDuration = Math.random() * 2 + 2 + "s";

        particleContainer.appendChild(confetti);

        setTimeout(() => {
          confetti.remove();
        }, 4000);
      }
    }

    document.addEventListener("keydown", (e) => {
      if (e.key >= "0" && e.key <= "9") {
        document.querySelectorAll("button").forEach((btn) => {
          if (btn.innerText === e.key) btn.click();
        });
      }
      if (e.key === "Enter" || e.key === "=") document.querySelector(".btn-equals").click();
      if (e.key === "Backspace") deleteLast();
      if (e.key === "Escape") clearDisplay();
      if (["+", "-", "*", "/"].includes(e.key)) {
        const map = { "*": "√ó", "/": "√∑" };
        let txt = map[e.key] || e.key;
        document.querySelectorAll("button").forEach((btn) => {
          if (btn.innerText === txt) btn.click();
        });
      }
    });
  </script>
</body>
</html>
